---
title: "Advanced Features"
description: "Webhooks, fee handling, custom metadata, and enterprise-grade capabilities"
---

## Overview

Request Network provides advanced features that enable enterprise-grade payment processing, real-time integrations, and sophisticated business logic. These capabilities ensure your payment infrastructure can scale with your business needs.

## Webhooks & Real-Time Updates

### Webhook Events
Stay synchronized with payment events through real-time webhook notifications.

<CardGroup cols={2}>
  <Card title="Payment Events" icon="credit-card">
    **Event Types:**
    - `payment_detected` - Payment initiated
    - `payment_confirmed` - Payment confirmed on blockchain
    - `payment_failed` - Payment failed or rejected
    
    **Use Cases:** Order fulfillment, inventory updates, customer notifications
  </Card>
  
  <Card title="Request Events" icon="file-invoice">
    **Event Types:**
    - `request_created` - New payment request created
    - `request_updated` - Request metadata or status changed
    - `request_cancelled` - Request cancelled by merchant
    
    **Use Cases:** CRM integration, accounting system updates
  </Card>
</CardGroup>

<CardGroup cols={2}>
  <Card title="Subscription Events" icon="repeat">
    **Event Types:**
    - `subscription_activated` - New subscription started
    - `subscription_renewed` - Successful recurring payment
    - `subscription_failed` - Recurring payment failed
    - `subscription_cancelled` - Subscription terminated
    
    **Use Cases:** [Subscription](/use-cases/subscriptions) management, customer lifecycle
  </Card>
  
  <Card title="Payout Events" icon="send">
    **Event Types:**
    - `payout_initiated` - Payout process started
    - `payout_completed` - Payout successfully sent
    - `batch_payout_completed` - All batch payments processed
    
    **Use Cases:** [Payroll](/use-cases/payroll) confirmation, vendor notifications
  </Card>
</CardGroup>

### Webhook Configuration

<Tabs>
  <Tab title="Setup">
    **Webhook Endpoint Setup:**
    
    1. Configure endpoint URL in Request Portal
    2. Select event types to receive
    3. Set up authentication (optional)
    4. Test webhook delivery
    
    ```javascript
    // Example webhook endpoint
    app.post('/webhooks/request-network', (req, res) => {
      const { eventType, data } = req.body;
      
      // Verify webhook signature (recommended)
      if (!verifyWebhookSignature(req)) {
        return res.status(401).send('Unauthorized');
      }
      
      // Process event
      handlePaymentEvent(eventType, data);
      
      res.status(200).send('OK');
    });
    ```
  </Tab>
  
  <Tab title="Security">
    **Webhook Security Best Practices:**
    
    - **Signature Verification:** Verify webhook authenticity
    - **HTTPS Only:** Always use secure endpoints
    - **Idempotency:** Handle duplicate events gracefully
    - **Rate Limiting:** Implement endpoint rate limiting
    
    ```javascript
    function verifyWebhookSignature(req) {
      const signature = req.headers['x-request-signature'];
      const payload = JSON.stringify(req.body);
      const expectedSignature = crypto
        .createHmac('sha256', webhookSecret)
        .update(payload)
        .digest('hex');
      
      return signature === expectedSignature;
    }
    ```
  </Tab>
  
  <Tab title="Retry Logic">
    **Automatic Retry Handling:**
    
    - **Retry Schedule:** 1s, 5s, 25s, 125s intervals
    - **Max Attempts:** Up to 5 retry attempts
    - **Exponential Backoff:** Increasing delays between retries
    - **Dead Letter Queue:** Failed events stored for manual review
    
    **Error Handling:**
    - Return 2xx status codes for successful processing
    - Return 4xx for permanent failures (no retry)
    - Return 5xx for temporary failures (will retry)
  </Tab>
</Tabs>

## Platform Fees & Revenue Sharing

### Fee Configuration
Collect platform fees automatically from every transaction.

<AccordionGroup>
  <Accordion title="Percentage-Based Fees">
    **Fixed Percentage Model:**
    - Set percentage fee (e.g., 2.5% per transaction)
    - Automatic fee calculation and collection
    - Fees collected to specified address
    - Real-time fee tracking and reporting
    
    **Perfect For:** Marketplaces, payment processors, SaaS platforms
  </Accordion>
  
  <Accordion title="Fixed Amount Fees">
    **Flat Fee Model:**
    - Set fixed fee amount per transaction
    - Independent of transaction size
    - Predictable fee structure
    - Suitable for high-volume, low-value transactions
    
    **Perfect For:** Micropayments, subscription services, utility payments
  </Accordion>
  
  <Accordion title="Tiered Fee Structures">
    **Volume-Based Pricing:**
    - Different fee rates based on transaction volume
    - Automatic tier calculation
    - Incentivize higher volume usage
    - Enterprise-friendly pricing models
    
    **Perfect For:** Enterprise platforms, high-volume merchants
  </Accordion>
  
  <Accordion title="Revenue Sharing">
    **Multi-Party Fee Distribution:**
    - Split fees between multiple parties
    - Automatic revenue distribution
    - Configurable split percentages
    - Real-time settlement
    
    **Perfect For:** Affiliate programs, partner ecosystems, marketplaces
  </Accordion>
</AccordionGroup>

### Fee Implementation

<CodeGroup>
```javascript Percentage Fee
const requestWithFee = await requestNetwork.createRequest({
  requestInfo: {
    currency: 'USDC-matic',
    expectedAmount: '1000',
    // ... other request details
  },
  paymentNetwork: {
    id: 'erc20-fee-proxy-contract',
    parameters: {
      paymentAddress: merchantAddress,
      feeAddress: platformFeeAddress,
      feeAmount: '25' // 2.5% fee
    }
  }
});
```

```javascript Fixed Fee
const requestWithFixedFee = await requestNetwork.createRequest({
  requestInfo: {
    currency: 'USDC-matic',
    expectedAmount: '1000',
    // ... other request details
  },
  paymentNetwork: {
    id: 'erc20-fee-proxy-contract',
    parameters: {
      paymentAddress: merchantAddress,
      feeAddress: platformFeeAddress,
      feeAmount: '10' // $10 fixed fee
    }
  }
});
```

```javascript Multi-Party Split
const revenueSharingRequest = await requestNetwork.createRequest({
  requestInfo: {
    currency: 'USDC-matic',
    expectedAmount: '1000',
    // ... other request details
  },
  paymentNetwork: {
    id: 'erc20-fee-proxy-contract',
    parameters: {
      paymentAddress: merchantAddress,
      feeAddress: platformFeeAddress,
      feeAmount: '50', // 5% to platform
      additionalFees: [
        {
          address: affiliateAddress,
          amount: '20' // 2% to affiliate
        }
      ]
    }
  }
});
```
</CodeGroup>

## Custom Metadata & Business Logic

### Metadata Capabilities
Attach business-specific data to payment requests and transactions.

<Tabs>
  <Tab title="Standard Metadata">
    **Built-in Fields:**
    - Invoice numbers and references
    - Customer information
    - Product/service descriptions
    - Due dates and payment terms
    - Tax information and rates
    
    ```javascript
    const requestWithMetadata = await requestNetwork.createRequest({
      // ... request configuration
      contentData: {
        reason: 'Professional Services - Q1 2025',
        invoiceNumber: 'INV-2025-001',
        dueDate: '2025-04-01',
        customerInfo: {
          name: 'Acme Corporation',
          email: 'billing@acme.com',
          taxId: 'US123456789'
        },
        lineItems: [
          {
            description: 'Consulting Services',
            quantity: 40,
            unitPrice: '150',
            total: '6000'
          }
        ]
      }
    });
    ```
  </Tab>
  
  <Tab title="Custom Fields">
    **Flexible Schema:**
    - Add any JSON-compatible data
    - Business-specific identifiers
    - Integration system references
    - Custom workflow states
    
    ```javascript
    const customMetadata = {
      // Standard invoice data
      reason: 'Software License Renewal',
      invoiceNumber: 'LIC-2025-456',
      
      // Custom business fields
      customFields: {
        salesRepId: 'REP-001',
        contractNumber: 'CON-2025-789',
        departmentCode: 'IT-DEV',
        projectId: 'PROJ-ALPHA',
        approvalRequired: true,
        priority: 'high'
      },
      
      // Integration references
      externalSystems: {
        crmId: 'SFDC-12345',
        erpOrderId: 'ERP-ORD-789',
        ticketNumber: 'TICKET-456'
      }
    };
    ```
  </Tab>
  
  <Tab title="Searchable Data">
    **Query Capabilities:**
    - Search requests by metadata fields
    - Filter by custom attributes
    - Generate custom reports
    - Business intelligence integration
    
    ```javascript
    // Search requests by metadata
    const requests = await requestNetwork.searchRequests({
      filters: {
        'contentData.customFields.departmentCode': 'IT-DEV',
        'contentData.customFields.priority': 'high',
        createdAt: {
          gte: '2025-01-01',
          lte: '2025-03-31'
        }
      }
    });
    ```
  </Tab>
</Tabs>

## Error Handling & Resilience

### Payment Failure Management
Robust error handling ensures reliable payment processing.

<CardGroup cols={2}>
  <Card title="Automatic Retry Logic" icon="refresh">
    **Smart Retry Mechanisms:**
    - Automatic retry for transient failures
    - Exponential backoff strategies
    - Maximum retry attempt limits
    - Configurable retry policies
    
    **Failure Types:**
    - Network connectivity issues
    - Temporary blockchain congestion
    - Insufficient gas fee scenarios
  </Card>
  
  <Card title="Grace Periods" icon="clock">
    **Payment Grace Handling:**
    - Configurable grace periods for late payments
    - Automatic payment retry scheduling
    - Customer notification workflows
    - Account suspension management
    
    **Use Cases:** [Subscription](/use-cases/subscriptions) billing, enterprise accounts
  </Card>
</CardGroup>

### Error Response Handling

<CodeGroup>
```javascript Error Handling
try {
  const payment = await requestNetwork.payRequest(requestId, {
    amount: paymentAmount,
    currency: paymentCurrency
  });
  
  console.log('Payment successful:', payment.transactionHash);
  
} catch (error) {
  switch (error.code) {
    case 'INSUFFICIENT_FUNDS':
      // Handle insufficient balance
      showInsufficientFundsError();
      break;
      
    case 'NETWORK_ERROR':
      // Retry payment after delay
      setTimeout(() => retryPayment(requestId), 5000);
      break;
      
    case 'INVALID_REQUEST':
      // Handle invalid request (don't retry)
      showInvalidRequestError();
      break;
      
    default:
      // Generic error handling
      showGenericPaymentError();
  }
}
```

```javascript Webhook Error Handling
app.post('/webhook/payment-events', async (req, res) => {
  try {
    const { eventType, data } = req.body;
    
    // Process event with error handling
    await processPaymentEvent(eventType, data);
    
    res.status(200).send('OK');
    
  } catch (error) {
    console.error('Webhook processing error:', error);
    
    // Return appropriate status code
    if (error.type === 'PERMANENT_ERROR') {
      res.status(400).send('Bad Request');
    } else {
      res.status(500).send('Internal Server Error');
    }
  }
});
```
</CodeGroup>

## Performance & Optimization

### Gas Fee Optimization
Minimize transaction costs through intelligent optimization.

<AccordionGroup>
  <Accordion title="Batch Transaction Optimization">
    **Efficient Batch Processing:**
    - Multiple payments in single transaction
    - Shared gas costs across recipients
    - Up to 90% gas savings for batch operations
    - Atomic execution guarantees
  </Accordion>
  
  <Accordion title="Network Selection">
    **Optimal Network Routing:**
    - Automatic network selection based on cost
    - Real-time gas price monitoring
    - Cross-chain routing for best rates
    - User preference consideration
  </Accordion>
  
  <Accordion title="Transaction Timing">
    **Smart Timing Strategies:**
    - Off-peak transaction scheduling
    - Gas price prediction and queuing
    - Priority fee optimization
    - Network congestion avoidance
  </Accordion>
</AccordionGroup>

## What's Next?

<CardGroup cols={3}>
  <Card 
    title="🛠️ Integration Patterns" 
    href="/api-features/integration-patterns"
    icon="puzzle-piece"
  >
    Learn common integration patterns and best practices
  </Card>
  
  <Card 
    title="📚 API Reference" 
    href="/api-reference/authentication"
    icon="book"
  >
    Detailed webhook and API endpoint documentation
  </Card>
  
  <Card 
    title="🔑 API Setup" 
    href="/api-setup/getting-started"
    icon="key"
  >
    Configure webhooks and advanced features
  </Card>
</CardGroup>
